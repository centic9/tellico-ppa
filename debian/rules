#!/usr/bin/make -f
# Sample debian/rules that uses debhelper.
# GNU copyright 1997 to 1999 by Joey Hess.

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

DEB_KDE_LINK_WITH_AS_NEEDED = yes

include /usr/share/pkg-kde-tools/makefiles/1/variables.mk

%:
	dh $@ --buildsystem=cmake --builddirectory=build

override_dh_auto_configure:
	dh_auto_configure -- \
		$(DEB_CMAKE_KDE4_FLAGS) \
		$(DEB_CMAKE_CUSTOM_FLAGS) \
		-DBUILD_TESTS=false \
		-DENABLE_WEBCAM=true

override_dh_shlibdeps:
	dh_shlibdeps -- -xkdepim-runtime

override_dh_compress:
	dh_compress -Xkde

binary-indep: build install
	dh_testdir
	dh_testroot
	dh_install -i
	dh_installdirs -i
	dh_installdocs -i AUTHORS COMPILING COPYING TODO README
	dh_installchangelogs -i ChangeLog
	dh_installexamples -i
	dh_installman -i
	dh_link -i
	dh_compress -i
	dh_fixperms -i
	dh_installdeb -i
	dh_gencontrol -i
	dh_md5sums -i
	dh_builddeb -i
	dh_lintian -i
	dh_perl -i
	# workaround to handle differences between Xenial and Yakkety
	-install -p -m 0755 debian/tmp/usr/share/appdata/* $(debdir)/usr/share/appdata/
	-install -p -m 0755 debian/tmp/usr/share/metainfo/* $(debdir)/usr/share/metainfo/
